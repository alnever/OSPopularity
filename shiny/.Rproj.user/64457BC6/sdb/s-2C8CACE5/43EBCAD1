{
    "collab_server" : "",
    "contents" : "\n# This is the server logic for a Shiny web application.\n# You can find out more about building applications with Shiny here:\n#\n# http://shiny.rstudio.com\n#\n# library(devtools)\n# install_github(\"osdata\",\"alnever\")\nlibrary(osdata)\n\nlibrary(shiny)\nrequire(googleVis)\nlibrary(reshape2)\n\nshinyServer(function(input, output) {\n\n      \n      minDate <- reactive({paste(input$minYear,'-',sprintf(\"%02d\",as.numeric(input$minMonth)), sep = \"\")})\n      maxDate <- reactive({paste(input$maxYear,'-',sprintf(\"%02d\",as.numeric(input$maxMonth)), sep = \"\")})\n      topTen  <- reactive({input$topTen})\n      showTab <- reactive({input$showTable})\n\n      output$outTimeFrame <- renderText(paste(minDate(),maxDate(),sep=\" - \"))\n      \n      prepareDataSet <- function(p_minDate, p_maxDate, p_topTen) {\n            osu <- subset(osusers, as.character(osusers$Date) >= p_minDate & as.character(osusers$Date) <= p_maxDate)  \n            if (p_topTen) {\n                  last_data <- osu[nrow(osu),]\n                  m <- melt(last_data[-1])\n                  m <- m[order(-m$value),]\n                  m <- m[1:10,]\n                  mnames <- as.character(m$variable)\n                  osu <- osu[,c(\"Date\",mnames)]\n            }\n            return(osu)\n      }\n      \n      myOptions <- list(\n                   page = 'enable',\n                   pageSize = 20,\n                   width = 800\n             )\n\n      output$popLineChart <- renderGvis({\n            osu <- prepareDataSet(minDate(),maxDate(),topTen())\n            gvisLineChart(data = osu, \n                          \"Date\", \n                          names(osu)[-1],\n                          options = list(height = 600, width = 800))\n      })\n      \n      output$popTable <- renderGvis({\n            if (showTab()) {\n                  osu <- prepareDataSet(minDate(),maxDate(),topTen())\n                  gvisTable(osu, options = myOptions)\n            }\n      })\n\n})\n",
    "created" : 1464601388306.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2780697595",
    "id" : "43EBCAD1",
    "lastKnownWriteTime" : 1464612914,
    "last_content_update" : 1464612914,
    "path" : "D:/Work/R/09/OS/shiny/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}